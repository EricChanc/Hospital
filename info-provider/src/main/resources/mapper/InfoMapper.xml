<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.mapper.InfoMapper">

    <resultMap type="com.example.entity.Info" id="InfoMap">
        <result property="id" column="id" jdbcType="INTEGER"/>
        <result property="infoCode" column="info_code" jdbcType="VARCHAR"/>
        <result property="infoName" column="info_name" jdbcType="VARCHAR"/>
        <result property="infoType" column="info_type" jdbcType="INTEGER"/>
        <result property="infoPic" column="info_pic" jdbcType="VARCHAR"/>
        <result property="info" column="info" jdbcType="VARCHAR"/>
        <result property="isHot" column="is_hot" jdbcType="INTEGER"/>
        <result property="createTime" column="create_time" jdbcType="VARCHAR"/>
        <result property="createUser" column="create_user" jdbcType="INTEGER"/>
        <result property="updateTime" column="update_time" jdbcType="VARCHAR"/>
        <result property="isDelete" column="is_delete" jdbcType="INTEGER"/>
        <result property="version" column="version" jdbcType="INTEGER"/>
    </resultMap>

    <select id="queryInfoPage" resultType="com.example.vo.InfoPageVo"
    parameterType="com.example.dto.InfoPageDto">
        select i.id,i.info_name infoName,i.create_time createTime
             ,i.info_pic infoPic,t.dict_name infoTypeName
        from info i,
             (
                 select dict_value,dict_name
                 from dictionary
                 where dict_type_id=(
                     select id
                     from dictionary_type
                     where type_code='INFO_TYPE'
                 )
             )t
        where i.info_type=t.dict_value
          and i.info_type=#{infoPageDto.infoType}
          and i.is_delete=0
    </select>
</mapper>

